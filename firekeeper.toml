[llm]
base_url = "https://openrouter.ai/api/v1"
model = "google/gemini-3-flash-preview"

[llm.headers]
X-Title = "firekeeper.ai"
HTTP-Referer = "https://github.com/firekeeper-ai/firekeeper"

[llm.body]
parallel_tool_calls = true

[[rules]]
name = "Documentation Sync"
description = "Ensure user-facing documentation is updated with CLI changes"
instruction = """
This is a CLI tool. Only user-facing changes require documentation updates.

User-facing changes that MUST be documented:
- New CLI commands, subcommands, or options
- Changes to CLI behavior or output format
- New features visible to end users
- New configuration options or changes to configuration schema
- Breaking changes to existing functionality
- Bug fixes that affect user-visible behavior

Internal changes that do NOT require documentation:
- Internal function implementations
- Code refactoring that doesn't change CLI behavior
- Internal helper functions or utilities
- Implementation details not exposed to users
- Internal tool implementations (files in src/tool/) used by the agent system
- Internal config optimizations (e.g., rule scope patterns, performance tuning)
"""
tip = """
Update README.md with examples and usage.
Update CHANGELOG.md under the [Unreleased] section.
Ensure CLI help text matches actual behavior.
Update configuration examples to reflect current format.
"""
scope = ["**/*.rs"]
max_files_per_task = 3

[[rules]]
name = "No Code Duplication"
description = "Prevent duplicate code across files"
instruction = """
Ensure modified content does not duplicate code from other files.
- If duplicating an existing function, the code should call that function instead.
- If duplicating a code block, a shared function should be extracted.

Ignore acceptable duplication:
- Trivial code (simple one-liners, common patterns like error handling)
- Test code and test utilities
- Similar but contextually different logic (e.g., different validation rules)
- Common patterns like builder methods, getters/setters
- Standard boilerplate (e.g., CLI argument parsing, config loading)
- Factory methods or templates that intentionally duplicate configuration

Focus on substantial logic duplication:
- Business logic duplicated across multiple files (>30 lines)
- Complex algorithms or calculations repeated
- Data transformation logic that's identical
"""
tip = """
Extract common code into shared functions or modules.
"""
scope = ["**/*.rs"]
max_files_per_task = 3

[[rules]]
name = "No Magic Numbers"
description = "Prevent hardcoded numeric literals"
instruction = """
Reject unexplained numeric literals in production code.

Allowed numbers (not magic):
- 0, 1, -1 in common contexts (array indexing, loop increments, exit codes, boolean-like values)
- Numbers in test files
- Numbers in configuration files
- Numbers with nearby explanatory comments (within 3 lines above or inline)
- Numbers in default value functions or factory methods with descriptive context
- HTTP status codes (200, 404, etc.)
- Common time values with clear context (60 for seconds/minutes, 24 for hours, 1000 for milliseconds)
- Array/collection sizes in obvious contexts (e.g., Vec::with_capacity(10) in tests)

Reject as magic numbers:
- Business logic constants without explanation (e.g., threshold values, multipliers, limits)
- Arbitrary timeouts or delays without context
- Numeric configuration values hardcoded in logic without comments
- Calculation constants without explanation
"""
tip = """
Define constants with descriptive names or add explanatory comments.
"""
scope = ["**/*.rs"]
max_files_per_task = 10

[[rules]]
name = "No Hardcoded Credentials"
description = "Prevent credential leaks"
instruction = """
Reject hardcoded credentials in code.

Forbidden:
- API keys, tokens, secrets (e.g., "sk-...", "Bearer ...", actual secret values)
- Passwords or password hashes
- Private keys or certificates
- OAuth client secrets
- Database connection strings with credentials

Allowed:
- Placeholder/example values (e.g., "your-api-key", "sk-xxxxxx", "<API_KEY>")
- Environment variable names (e.g., "FIREKEEPER_LLM_API_KEY")
- Public URLs and endpoints
- Email addresses and contact information
- Test/mock credentials in test files clearly marked as fake
- Documentation examples with obvious placeholders
"""
tip = """
Use environment variables or configuration files for credentials.
Replace real values with placeholders in examples.
"""
scope = ["**/*"]
max_files_per_task = 10
