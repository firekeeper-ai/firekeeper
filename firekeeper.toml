# LLM provider configuration
[llm]
# OpenAI compatible API base URL
base_url = "https://openrouter.ai/api/v1"
# LLM model name
model = "google/gemini-3-flash-preview"

# Custom HTTP headers (optional)
[llm.headers]
X-Title = "firekeeper.ai"
HTTP-Referer = "https://github.com/firekeeper-ai/firekeeper"

# Custom request body fields (optional)
[llm.body]
parallel_tool_calls = true

# Code review configuration
[review]
# Maximum number of files to review per task
max_files_per_task = 5
# Global resources to include in review context (file://glob, skill://glob, or sh://command)
resources = []
# Maximum number of parallel workers (optional, defaults to unlimited)
# max_parallel_workers = ...

# Code review rules
[[rules]]
# Human-readable rule name, invisible to LLM
name = "Documentation Sync"
# Human-readable description, invisible to LLM (optional)
description = "Ensure user-facing documentation is updated with CLI changes"
# Detailed instructions for the LLM on how to check this rule
instruction = """
Check if user-facing changes have corresponding documentation updates.

Steps:
1. Read focused files to identify if changes are user-facing
2. Check if code comments (function docs, inline comments) are updated to match code changes
3. If user-facing, check CHANGELOG.md for updates under [Unreleased]
4. Check if README.md has outdated information that needs correction
5. Report violations if documentation is missing or outdated

Violation criteria - Report if ANY of these are true:
- Code behavior changed but comments/doc comments not updated
- Function signatures changed but doc comments still describe old behavior
- User-facing changes not documented in CHANGELOG.md under [Unreleased]
- README.md contains outdated information contradicting the changes
- Breaking changes not documented in CHANGELOG

Note: Don't require adding new content to README (e.g., new features/commands).
Only update README if existing content becomes outdated.

Exemptions - Do NOT report if changes are:
- Internal function implementations (not exposed to CLI)
- Code refactoring without behavior changes
- Internal helper functions or utilities
- Internal tool implementations (src/tool/) for agent system
- Internal config optimizations (scope patterns, performance tuning)
"""
# Tip for downstream processors (e.g. coding agents) to fix violations (optional)
tip = """
"""
# Glob patterns to match files this rule applies to (optional, defaults to ["**/*"])
scope = ["**/*.rs"]
# Maximum number of files to review per task (optional, overrides global config).
# Increase for simple rules that only check changed files (e.g. scan for hardcoded credentials).
# Decrease for complex rules that scan many additional files (e.g. documentation sync).
max_files_per_task = 3
# Rule-specific resources to include in review context (file://glob, skill://glob, or sh://command)
resources = ["file://README.md", "sh://git ls-files"]

# Code review rules
[[rules]]
# Human-readable rule name, invisible to LLM
name = "No Code Duplication"
# Human-readable description, invisible to LLM (optional)
description = "Prevent duplicate code across files"
# Detailed instructions for the LLM on how to check this rule
instruction = """
Check if modified code duplicates existing code in other files.

Steps:
1. Read focused files to understand the modified logic
2. Search for similar code patterns in other files
3. Report violations if substantial duplication is found

Violation criteria - Report if:
- Business logic duplicated across files (>30 lines of similar code)
- Complex algorithms or calculations repeated identically
- Data transformation logic that's the same in multiple places
- Functions that could be extracted into shared utilities

Exemptions - Do NOT report:
- Trivial code (one-liners, common patterns like error handling)
- Test code and test utilities
- Similar but contextually different logic (e.g., different validation rules)
- Common patterns (builder methods, getters/setters)
- Standard boilerplate (CLI parsing, config loading)
- Factory methods or templates with intentional configuration duplication
"""
# Tip for downstream processors (e.g. coding agents) to fix violations (optional)
tip = """
Extract common code into shared functions or modules.
"""
# Glob patterns to match files this rule applies to (optional, defaults to ["**/*"])
scope = ["**/*.rs"]
# Maximum number of files to review per task (optional, overrides global config).
# Increase for simple rules that only check changed files (e.g. scan for hardcoded credentials).
# Decrease for complex rules that scan many additional files (e.g. documentation sync).
max_files_per_task = 3
# Rule-specific resources to include in review context (file://glob, skill://glob, or sh://command)
resources = ["file://README.md", "sh://git ls-files"]

# Code review rules
[[rules]]
# Human-readable rule name, invisible to LLM
name = "No Magic Numbers"
# Human-readable description, invisible to LLM (optional)
description = "Prevent hardcoded numeric literals"
# Detailed instructions for the LLM on how to check this rule
instruction = """
Only read the focused files. Don't read any other files.

Check for unexplained numeric literals in diff.

Steps:
1. Read focused files and identify numeric literals
2. Check if numbers have explanatory comments or clear context
3. Report violations for unexplained numbers

Violation criteria - Report if:
- Business logic constants without explanation (thresholds, multipliers, limits)
- Arbitrary timeouts or delays without context
- Numeric configuration values hardcoded in logic without comments
- Calculation constants without explanation

Exemptions - Do NOT report:
- 0, 1, -1 in common contexts (indexing, loops, exit codes, boolean-like)
- Numbers in test files
- Numbers in configuration files
- Numbers with nearby comments (within 3 lines above or inline)
- Numbers in default value functions with descriptive context
- HTTP status codes (200, 404, etc.)
- Common time values with clear context (60 for seconds, 24 for hours, 1000 for ms)
- Array/collection sizes in obvious contexts (e.g., Vec::with_capacity(10) in tests)
"""
# Tip for downstream processors (e.g. coding agents) to fix violations (optional)
tip = """
Define constants with descriptive names or add explanatory comments.
"""
# Glob patterns to match files this rule applies to (optional, defaults to ["**/*"])
scope = ["**/*.rs"]
# Maximum number of files to review per task (optional, overrides global config).
# Increase for simple rules that only check changed files (e.g. scan for hardcoded credentials).
# Decrease for complex rules that scan many additional files (e.g. documentation sync).
max_files_per_task = 10

# Code review rules
[[rules]]
# Human-readable rule name, invisible to LLM
name = "No Hardcoded Credentials"
# Human-readable description, invisible to LLM (optional)
description = "Prevent credential leaks"
# Detailed instructions for the LLM on how to check this rule
instruction = """
Only read the focused files. Don't read any other files.

Check for hardcoded credentials in diff.

Steps:
1. Read focused files and scan for credential-like strings
2. Determine if they are real credentials or placeholders
3. Report violations for any real credentials found

Violation criteria - Report if ANY found:
- API keys, tokens, secrets (e.g., "sk-...", "Bearer ...", actual secret values)
- Passwords or password hashes
- Private keys or certificates
- OAuth client secrets
- Database connection strings with credentials

Exemptions - Do NOT report:
- Placeholder/example values (e.g., "your-api-key", "sk-xxxxxx", "<API_KEY>")
- Environment variable names (e.g., "FIREKEEPER_LLM_API_KEY")
- Public URLs and endpoints
- Email addresses and contact information
- Test/mock credentials in test files clearly marked as fake
- Documentation examples with obvious placeholders
"""
# Tip for downstream processors (e.g. coding agents) to fix violations (optional)
tip = """
Use environment variables or configuration files for credentials.
Replace real values with placeholders in examples.
"""
# Glob patterns to match files this rule applies to (optional, defaults to ["**/*"])
scope = ["**/*"]
# Maximum number of files to review per task (optional, overrides global config).
# Increase for simple rules that only check changed files (e.g. scan for hardcoded credentials).
# Decrease for complex rules that scan many additional files (e.g. documentation sync).
max_files_per_task = 10
